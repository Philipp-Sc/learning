!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){var r,i=function(e){var t="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",n=["1-0","0-1","1/2-1/2","*"],r={b:[16,32,17,15],w:[-16,-32,-17,-15]},i={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},a=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],o=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],l={p:0,n:1,b:2,r:3,q:4,k:5},p={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},c={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},u={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},s={w:[{square:u.a1,flag:c.QSIDE_CASTLE},{square:u.h1,flag:c.KSIDE_CASTLE}],b:[{square:u.a8,flag:c.QSIDE_CASTLE},{square:u.h8,flag:c.KSIDE_CASTLE}]},f=new Array(128),h={w:-1,b:-1},d="w",g={w:0,b:0},v=-1,P=0,b=1,_=[],w={},m={};function k(e){void 0===e&&(e=!1),f=new Array(128),h={w:-1,b:-1},d="w",g={w:0,b:0},v=-1,P=0,b=1,_=[],e||(w={}),m={},q(C())}function E(){for(var e=[],t={},n=function(e){e in m&&(t[e]=m[e])};_.length>0;)e.push(H());for(n(C());e.length>0;)U(e.pop()),n(C());m=t}function O(){A(t)}function A(e,t){void 0===t&&(t=!1);var n=e.split(/\s+/),r=n[0],i=0;if(!S(e).valid)return!1;k(t);for(var a=0;a<r.length;a++){var o=r.charAt(a);if("/"===o)i+=8;else if(-1!=="0123456789".indexOf(o))i+=parseInt(o,10);else{var l=o<"a"?"w":"b";L({type:o.toLowerCase(),color:l},z(i)),i++}}return d=n[1],n[2].indexOf("K")>-1&&(g.w|=c.KSIDE_CASTLE),n[2].indexOf("Q")>-1&&(g.w|=c.QSIDE_CASTLE),n[2].indexOf("k")>-1&&(g.b|=c.KSIDE_CASTLE),n[2].indexOf("q")>-1&&(g.b|=c.QSIDE_CASTLE),v="-"===n[3]?-1:u[n[3]],P=parseInt(n[4],10),b=parseInt(n[5],10),q(C()),!0}function S(e){var t="No errors.",n="FEN string must contain six space-delimited fields.",r="6th field (move number) must be a positive integer.",i="5th field (half move counter) must be a non-negative integer.",a="4th field (en-passant square) is invalid.",o="3rd field (castling availability) is invalid.",l="2nd field (side to move) is invalid.",p="1st field (piece positions) does not contain 8 '/'-delimited rows.",c="1st field (piece positions) is invalid [consecutive numbers].",u="1st field (piece positions) is invalid [invalid piece].",s="1st field (piece positions) is invalid [row too large].",f="Illegal en-passant square",h=e.split(/\s+/);if(6!==h.length)return{valid:!1,error_number:1,error:n};if(isNaN(h[5])||parseInt(h[5],10)<=0)return{valid:!1,error_number:2,error:r};if(isNaN(h[4])||parseInt(h[4],10)<0)return{valid:!1,error_number:3,error:i};if(!/^(-|[abcdefgh][36])$/.test(h[3]))return{valid:!1,error_number:4,error:a};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(h[2]))return{valid:!1,error_number:5,error:o};if(!/^(w|b)$/.test(h[1]))return{valid:!1,error_number:6,error:l};var d=h[0].split("/");if(8!==d.length)return{valid:!1,error_number:7,error:p};for(var g=0;g<d.length;g++){for(var v=0,P=!1,b=0;b<d[g].length;b++)if(isNaN(d[g][b])){if(!/^[prnbqkPRNBQK]$/.test(d[g][b]))return{valid:!1,error_number:9,error:u};v+=1,P=!1}else{if(P)return{valid:!1,error_number:8,error:c};v+=parseInt(d[g][b],10),P=!0}if(8!==v)return{valid:!1,error_number:10,error:s}}return"3"==h[3][1]&&"w"==h[1]||"6"==h[3][1]&&"b"==h[1]?{valid:!1,error_number:11,error:f}:{valid:!0,error_number:0,error:t}}function C(){for(var e=0,t="",n=u.a8;n<=u.h1;n++){if(null==f[n])e++;else{e>0&&(t+=e,e=0);var r=f[n].color,i=f[n].type;t+="w"===r?i.toUpperCase():i.toLowerCase()}n+1&136&&(e>0&&(t+=e),n!==u.h1&&(t+="/"),e=0,n+=8)}var a="";g.w&c.KSIDE_CASTLE&&(a+="K"),g.w&c.QSIDE_CASTLE&&(a+="Q"),g.b&c.KSIDE_CASTLE&&(a+="k"),g.b&c.QSIDE_CASTLE&&(a+="q"),a=a||"-";var o=-1===v?"-":z(v);return[t,d,a,o,P,b].join(" ")}function y(e){for(var t=0;t<e.length;t+=2)"string"==typeof e[t]&&"string"==typeof e[t+1]&&(w[e[t]]=e[t+1]);return w}function q(e){_.length>0||(e!==t?(w.SetUp="1",w.FEN=e):(delete w.SetUp,delete w.FEN))}function x(e){var t=f[u[e]];return t?{type:t.type,color:t.color}:null}function L(e,t){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(t in u))return!1;var n=u[t];return("k"!=e.type||-1==h[e.color]||h[e.color]==n)&&(f[n]={type:e.type,color:e.color},"k"===e.type&&(h[e.color]=n),q(C()),!0)}function N(e,t,n,r,i){var a={color:d,from:t,to:n,flags:r,piece:e[t].type};return i&&(a.flags|=c.PROMOTION,a.promotion=i),e[n]?a.captured=e[n].type:r&c.EP_CAPTURE&&(a.captured="p"),a}function I(e){function t(e,t,n,r,i){if("p"!==e[n].type||0!==G(r)&&7!==G(r))t.push(N(e,n,r,i));else for(var a=["q","r","b","n"],o=0,l=a.length;o<l;o++)t.push(N(e,n,r,i,a[o]))}var n=[],a=d,o=Z(a),l={b:1,w:6},p=u.a8,s=u.h1,P=!1,b=void 0===e||!("legal"in e)||e.legal;if(void 0!==e&&"square"in e){if(!(e.square in u))return[];p=s=u[e.square],P=!0}for(var _=p;_<=s;_++)if(136&_)_+=7;else{var w=f[_];if(null!=w&&w.color===a)if("p"===w.type){var m=_+r[a][0];if(null==f[m]){t(f,n,_,m,c.NORMAL);m=_+r[a][1];l[a]===G(_)&&null==f[m]&&t(f,n,_,m,c.BIG_PAWN)}for(k=2;k<4;k++){136&(m=_+r[a][k])||(null!=f[m]&&f[m].color===o?t(f,n,_,m,c.CAPTURE):m===v&&t(f,n,_,v,c.EP_CAPTURE))}}else for(var k=0,E=i[w.type].length;k<E;k++){var O=i[w.type][k];for(m=_;!(136&(m+=O));){if(null!=f[m]){if(f[m].color===a)break;t(f,n,_,m,c.CAPTURE);break}if(t(f,n,_,m,c.NORMAL),"n"===w.type||"k"===w.type)break}}}if(!P||s===h[a]){if(g[a]&c.KSIDE_CASTLE){var A=(S=h[a])+2;null!=f[S+1]||null!=f[A]||T(o,h[a])||T(o,S+1)||T(o,A)||t(f,n,h[a],A,c.KSIDE_CASTLE)}if(g[a]&c.QSIDE_CASTLE){var S;A=(S=h[a])-2;null!=f[S-1]||null!=f[S-2]||null!=f[S-3]||T(o,h[a])||T(o,S-1)||T(o,A)||t(f,n,h[a],A,c.QSIDE_CASTLE)}}if(!b)return n;var C=[];for(_=0,E=n.length;_<E;_++)U(n[_]),K(a)||C.push(n[_]),H();return C}function R(e,t){var n="";if(e.flags&c.KSIDE_CASTLE)n="O-O";else if(e.flags&c.QSIDE_CASTLE)n="O-O-O";else{var r=function(e,t){for(var n=I({legal:!t}),r=e.from,i=e.to,a=e.piece,o=0,l=0,p=0,c=0,u=n.length;c<u;c++){var s=n[c].from,f=n[c].to,h=n[c].piece;a===h&&r!==s&&i===f&&(o++,G(r)===G(s)&&l++,W(r)===W(s)&&p++)}if(o>0)return l>0&&p>0?z(r):p>0?z(r).charAt(1):z(r).charAt(0);return""}(e,t);"p"!==e.piece&&(n+=e.piece.toUpperCase()+r),e.flags&(c.CAPTURE|c.EP_CAPTURE)&&("p"===e.piece&&(n+=z(e.from)[0]),n+="x"),n+=z(e.to),e.flags&c.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return U(e),Q()&&(j()?n+="#":n+="+"),H(),n}function F(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function T(e,t){for(var n=u.a8;n<=u.h1;n++)if(136&n)n+=7;else if(null!=f[n]&&f[n].color===e){var r=f[n],i=n-t,p=i+119;if(a[p]&1<<l[r.type]){if("p"===r.type){if(i>0){if("w"===r.color)return!0}else if("b"===r.color)return!0;continue}if("n"===r.type||"k"===r.type)return!0;for(var c=o[p],s=n+c,h=!1;s!==t;){if(null!=f[s]){h=!0;break}s+=c}if(!h)return!0}}return!1}function K(e){return T(Z(e),h[e])}function Q(){return K(d)}function j(){return Q()&&0===I().length}function D(){return!Q()&&0===I().length}function M(){for(var e={},t=[],n=0,r=0,i=u.a8;i<=u.h1;i++)if(r=(r+1)%2,136&i)i+=7;else{var a=f[i];a&&(e[a.type]=a.type in e?e[a.type]+1:1,"b"===a.type&&t.push(r),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var o=0,l=t.length;for(i=0;i<l;i++)o+=t[i];if(0===o||o===l)return!0}return!1}function B(){for(var e=[],t={},n=!1;;){var r=H();if(!r)break;e.push(r)}for(;;){var i=C().split(" ").slice(0,4).join(" ");if(t[i]=i in t?t[i]+1:1,t[i]>=3&&(n=!0),!e.length)break;U(e.pop())}return n}function U(e){var t=d,n=Z(t);if(function(e){_.push({move:e,kings:{b:h.b,w:h.w},turn:d,castling:{b:g.b,w:g.w},ep_square:v,half_moves:P,move_number:b})}(e),f[e.to]=f[e.from],f[e.from]=null,e.flags&c.EP_CAPTURE&&("b"===d?f[e.to-16]=null:f[e.to+16]=null),e.flags&c.PROMOTION&&(f[e.to]={type:e.promotion,color:t}),"k"===f[e.to].type){if(h[f[e.to].color]=e.to,e.flags&c.KSIDE_CASTLE){var r=e.to-1,i=e.to+1;f[r]=f[i],f[i]=null}else if(e.flags&c.QSIDE_CASTLE){r=e.to+1,i=e.to-2;f[r]=f[i],f[i]=null}g[t]=""}if(g[t])for(var a=0,o=s[t].length;a<o;a++)if(e.from===s[t][a].square&&g[t]&s[t][a].flag){g[t]^=s[t][a].flag;break}if(g[n])for(a=0,o=s[n].length;a<o;a++)if(e.to===s[n][a].square&&g[n]&s[n][a].flag){g[n]^=s[n][a].flag;break}v=e.flags&c.BIG_PAWN?"b"===d?e.to-16:e.to+16:-1,"p"===e.piece||e.flags&(c.CAPTURE|c.EP_CAPTURE)?P=0:P++,"b"===d&&b++,d=Z(d)}function H(){var e=_.pop();if(null==e)return null;var t=e.move;h=e.kings,d=e.turn,g=e.castling,v=e.ep_square,P=e.half_moves,b=e.move_number;var n,r,i=d,a=Z(d);if(f[t.from]=f[t.to],f[t.from].type=t.piece,f[t.to]=null,t.flags&c.CAPTURE)f[t.to]={type:t.captured,color:a};else if(t.flags&c.EP_CAPTURE){var o;o="b"===i?t.to-16:t.to+16,f[o]={type:"p",color:a}}t.flags&(c.KSIDE_CASTLE|c.QSIDE_CASTLE)&&(t.flags&c.KSIDE_CASTLE?(n=t.to+1,r=t.to-1):t.flags&c.QSIDE_CASTLE&&(n=t.to-2,r=t.to+1),f[n]=f[r],f[r]=null);return t}function $(e,t){var n=F(e);if(t){var r=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(r)var i=r[1],a=r[2],o=r[3],l=r[4]}for(var p=I(),c=0,s=p.length;c<s;c++){if(n===F(R(p[c]))||t&&n===F(R(p[c],!0)))return p[c];if(r&&(!i||i.toLowerCase()==p[c].piece)&&u[a]==p[c].from&&u[o]==p[c].to&&(!l||l.toLowerCase()==p[c].promotion))return p[c]}return null}function G(e){return e>>4}function W(e){return 15&e}function z(e){var t=W(e),n=G(e);return"abcdefgh".substring(t,t+1)+"87654321".substring(n,n+1)}function Z(e){return"w"===e?"b":"w"}function V(e){var t=function e(t){var n=t instanceof Array?[]:{};for(var r in t)n[r]="object"==typeof r?e(t[r]):t[r];return n}(e);t.san=R(t,!1),t.to=z(t.to),t.from=z(t.from);var n="";for(var r in c)c[r]&t.flags&&(n+=p[r]);return t.flags=n,t}function J(e){return e.replace(/^\s+|\s+$/g,"")}return A(void 0===e?t:e),{WHITE:"w",BLACK:"b",PAWN:"p",KNIGHT:"n",BISHOP:"b",ROOK:"r",QUEEN:"q",KING:"k",SQUARES:function(){for(var e=[],t=u.a8;t<=u.h1;t++)136&t?t+=7:e.push(z(t));return e}(),FLAGS:p,load:function(e){return A(e)},reset:function(){return O()},moves:function(e){for(var t=I(e),n=[],r=0,i=t.length;r<i;r++)void 0!==e&&"verbose"in e&&e.verbose?n.push(V(t[r])):n.push(R(t[r],!1));return n},in_check:function(){return Q()},in_checkmate:function(){return j()},in_stalemate:function(){return D()},in_draw:function(){return P>=100||D()||M()||B()},insufficient_material:function(){return M()},in_threefold_repetition:function(){return B()},game_over:function(){return P>=100||j()||D()||M()||B()},validate_fen:function(e){return S(e)},fen:function(){return C()},board:function(){for(var e=[],t=[],n=u.a8;n<=u.h1;n++)null==f[n]?t.push(null):t.push({type:f[n].type,color:f[n].color}),n+1&136&&(e.push(t),t=[],n+=8);return e},pgn:function(e){var t="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\n",n="object"==typeof e&&"number"==typeof e.max_width?e.max_width:0,r=[],i=!1;for(var a in w)r.push("["+a+' "'+w[a]+'"]'+t),i=!0;i&&_.length&&r.push(t);for(var o=function(e){var t=m[C()];void 0!==t&&(e=`${e}${e.length>0?" ":""}{${t}}`);return e},l=[];_.length>0;)l.push(H());var p=[],c="";for(0===l.length&&p.push(o(""));l.length>0;){c=o(c);var u=l.pop();_.length||"b"!==u.color?"w"===u.color&&(c.length&&p.push(c),c=b+"."):c=b+". ...",c=c+" "+R(u,!1),U(u)}if(c.length&&p.push(o(c)),void 0!==w.Result&&p.push(w.Result),0===n)return r.join("")+p.join(" ");var s=function(){return r.length>0&&" "===r[r.length-1]&&(r.pop(),!0)},f=function(e,i){for(var a of i.split(" "))if(a){if(e+a.length>n){for(;s();)e--;r.push(t),e=0}r.push(a),e+=a.length,r.push(" "),e++}return s()&&e--,e},h=0;for(a=0;a<p.length;a++)h+p[a].length>n&&p[a].includes("{")?h=f(h,p[a]):(h+p[a].length>n&&0!==a?(" "===r[r.length-1]&&r.pop(),r.push(t),h=0):0!==a&&(r.push(" "),h++),r.push(p[a]),h+=p[a].length);return r.join("")},load_pgn:function(e,t){var r=void 0!==t&&"sloppy"in t&&t.sloppy;function i(e){return e.replace(/\\/g,"\\")}var a="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",o=new RegExp("^(\\[((?:"+i(a)+")|.)*\\])(?:"+i(a)+"){2}"),l=o.test(e)?o.exec(e)[1]:"";O();var p=function(e,t){for(var n="object"==typeof t&&"string"==typeof t.newline_char?t.newline_char:"\r?\n",r={},a=e.split(new RegExp(i(n))),o="",l="",p=0;p<a.length;p++)o=a[p].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),l=a[p].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),J(o).length>0&&(r[o]=l);return r}(l,t);for(var c in p)y([c,p[c]]);if(!("1"!==p.SetUp||"FEN"in p&&A(p.FEN,!0)))return!1;for(var u=function(e){return`{${function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}((e=e.replace(new RegExp(i(a),"g")," ")).slice(1,e.length-1))}}`},s=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},f=e.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${i(a)}]*)`,"g"),(function(e,t,n){return void 0!==t?u(t):" "+u(`{${n.slice(1)}}`)})).replace(new RegExp(i(a),"g")," "),h=/(\([^\(\)]+\))+?/g;h.test(f);)f=f.replace(h,"");var d=J(f=(f=(f=f.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));d=d.join(",").replace(/,,+/g,",").split(",");for(var g="",v=0;v<d.length-1;v++){var P=s(d[v]);if(void 0===P){if(null==(g=$(d[v],r)))return!1;U(g)}else m[C()]=P}if(void 0!==(P=s(d[d.length-1]))&&(m[C()]=P,d.pop()),g=d[d.length-1],n.indexOf(g)>-1)(function(e){for(var t in e)return!0;return!1})(w)&&void 0===w.Result&&y(["Result",g]);else{if(null==(g=$(g,r)))return!1;U(g)}return!0},header:function(){return y(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",t=u.a8;t<=u.h1;t++){if(0===W(t)&&(e+=" "+"87654321"[G(t)]+" |"),null==f[t])e+=" . ";else{var n=f[t].type;e+=" "+("w"===f[t].color?n.toUpperCase():n.toLowerCase())+" "}t+1&136&&(e+="|\n",t+=8)}return e+="   +------------------------+\n",e+="     a  b  c  d  e  f  g  h\n"}()},turn:function(){return d},move:function(e,t){var n=void 0!==t&&"sloppy"in t&&t.sloppy,r=null;if("string"==typeof e)r=$(e,n);else if("object"==typeof e)for(var i=I(),a=0,o=i.length;a<o;a++)if(e.from===z(i[a].from)&&e.to===z(i[a].to)&&(!("promotion"in i[a])||e.promotion===i[a].promotion)){r=i[a];break}if(!r)return null;var l=V(r);return U(r),l},undo:function(){var e=H();return e?V(e):null},clear:function(){return k()},put:function(e,t){return L(e,t)},get:function(e){return x(e)},remove:function(e){return function(e){var t=x(e);return f[u[e]]=null,t&&"k"===t.type&&(h[t.color]=-1),q(C()),t}(e)},perft:function(e){return function e(t){for(var n=I({legal:!1}),r=0,i=d,a=0,o=n.length;a<o;a++){if(U(n[a]),!K(i))if(t-1>0)r+=e(t-1);else r++;H()}return r}(e)},square_color:function(e){if(e in u){var t=u[e];return(G(t)+W(t))%2==0?"light":"dark"}return null},history:function(e){for(var t=[],n=[],r=(void 0!==e&&"verbose"in e&&e.verbose);_.length>0;)t.push(H());for(;t.length>0;){var i=t.pop();r?n.push(V(i)):n.push(R(i)),U(i)}return n},get_comment:function(){return m[C()]},set_comment:function(e){m[C()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=m[C()];return delete m[C()],e},get_comments:function(){return E(),Object.keys(m).map((function(e){return{fen:e,comment:m[e]}}))},delete_comments:function(){return E(),Object.keys(m).map((function(e){var t=m[e];return delete m[e],{fen:e,comment:t}}))}}};t.Chess=i,void 0===(r=function(){return i}.call(t,n,t,e))||(e.exports=r)},function(e,t,n){"use strict";n.r(t),n.d(t,"allKeys",(function(){return L})),n.d(t,"getCP",(function(){return N})),n.d(t,"getStatisticsForPositionDict",(function(){return I})),n.d(t,"getStatisticsForPositionVector",(function(){return R})),n.d(t,"getStatisticsForPosition",(function(){return F}));const r=["a","b","c","d","e","f","g","h"],i=["{fig} Pawn {white}","{fig} Pawn {black}","{fig} Bishop {white}","{fig} Bishop {black}","{fig} Knight {white}","{fig} Knight {black}","{fig} Rook {white}","{fig} Rook {black}","{fig} Queen {white}","{fig} Queen {black}","{fig} King {white}","{fig} King {black}","{capture} Px {white}","{capture} px {black}","{capture} Bx {white}","{capture} bx {black}","{capture} Nx {white}","{capture} nx {black}","{capture} Qx {white}","{capture} qx {black}","{capture} Rx {white}","{capture} rx {black}","{capture} Kx {white}","{capture} kx {black}","{castle} 0-0 {white}","{castle} 0-0 {black}","{castle} 0-0-0 {white}","{castle} 0-0-0 {black}","move to file A","move to rank 1","move to file B","move to rank 2","move to file C","move to rank 3","move to file D","move to rank 4","move to file E","move to rank 5","move to file F","move to rank 6","move to file G","move to rank 7","move to file H","move to rank 8"];function a(e,t){return"white"==e?"P"==t||"B"==t||"N"==t||"R"==t||"Q"==t:"black"==e?"p"==t||"b"==t||"n"==t||"r"==t||"q"==t:"p"==t||"b"==t||"n"==t||"r"==t||"q"==t||"P"==t||"B"==t||"N"==t||"R"==t||"Q"==t}function o(e){return e.turn?e.turn:e.color}function l(e,t){var n="w"==o(e),a=!n,l=function(e){return e.notation?e.notation.notation:e.san}(e),p=l.toLowerCase(),c=function(e){return e.notation?e.notation.fig:"p"==e.piece?null:e.piece.toUpperCase()}(e),u=l.includes("x"),s=p!=l,f=function(e){if(e.notation)var t=r.indexOf(e.notation.col);else t=r.indexOf(e.to.split("")[0]);return isNaN(t)?-1:t}(e),h=function(e){if(e.notation)var t=parseInt(e.notation.row);else t=parseInt(e.to.split("")[1]);return isNaN(t)?-1:t}(e),d=[n&&!s&&null==c?1:0,a&&!s&&null==c?1:0,n&&s&&"B"==c?1:0,a&&s&&"B"==c?1:0,n&&s&&"N"==c?1:0,a&&s&&"N"==c?1:0,n&&s&&"R"==c?1:0,a&&s&&"R"==c?1:0,n&&s&&"Q"==c?1:0,a&&s&&"Q"==c?1:0,n&&s&&"K"==c?1:0,a&&s&&"K"==c?1:0,n&&u&&!s&&null==c?1:0,a&&u&&!s&&null==c?1:0,n&&u&&s&&"B"==c?1:0,a&&u&&s&&"B"==c?1:0,n&&u&&s&&"N"==c?1:0,a&&u&&s&&"N"==c?1:0,n&&u&&s&&"Q"==c?1:0,a&&u&&s&&"Q"==c?1:0,n&&u&&s&&"R"==c?1:0,a&&u&&s&&"R"==c?1:0,n&&u&&s&&"K"==c?1:0,a&&u&&s&&"K"==c?1:0,n&&"O-O"==l?1:0,a&&"O-O"==l?1:0,n&&"O-O-O"==l?1:0,a&&"O-O-O"==l?1:0,0==f?1:0,1==h?1:0,1==f?1:0,2==h?1:0,2==f?1:0,3==h?1:0,3==f?1:0,4==h?1:0,4==f?1:0,5==h?1:0,5==f?1:0,6==h?1:0,6==f?1:0,7==h?1:0,7==f?1:0,8==h?1:0];if(t)return d;var g={};return d.forEach((e,t)=>{g[i[t]]=e}),g}const p=e=>e.reduce((e,t)=>e+t,0),c=e=>p(e)/e.length,u=(e,t)=>{for(var n=[],r=0;r<e.length||r<t.length;r++)n.push(e[r]+t[r]);return n};const s=i.map(e=>"{history} "+e);const f=[1,2,3,4,5,6,7,8],h=["Opponement Mobility (All)","Opponement Mobility (Pieces)","Opponement Mobility (Pawns)","Opponement Mobility (King)","Opponement Mobility (Queen)","Opponement Space Area (Unprotected)"];function d(e,t,n,r,i){var l=t.split(" ",1)[0].split(""),p=(l.filter(e=>a("white",e)),l.filter(e=>a("black",e)),e.moves()),c=p.filter(e=>2==e.length&&e.toLowerCase()==e),u=p.filter(e=>e.toLowerCase()!=e),s="b"==o(n),d=(u.filter(e=>!e.includes("Q")&&!e.includes("K")).length,u.filter(e=>e.includes("Q")).length),g=u.filter(e=>e.includes("K")).length;var v=e.moves({verbose:!0}).filter(e=>"p"!=e.piece.toLowerCase()).filter(e=>"q"!=e.piece.toLowerCase()&&"k"!=e.piece.toLowerCase()).filter(e=>0==["1","2","7","8","a","b","g","h"].map(t=>e.to.includes(t)).filter(e=>e).length).map(t=>{var n=t.to.split("");return{square:t,isBehindPawn:f.filter(e=>![1,8].includes(e)).filter(r=>((t,n,r,i)=>{var a,o,l=parseInt(t);if(s?(a=n<l,o=l-n):(a=n>l,o=n-l),o<=3&&a){var p=e.get(r.split("")[0]+n);if(p)return"p"==p.type&&p.color==i}return!1})(n[1],r,t.to,t.color))}}).filter(e=>e.isBehindPawn.length>0).map(e=>e.square),P=(v=new Set(v)).size,b=[p.length,u.length,c.length,g,d,P];if(i)return b;var _={};return b.forEach((e,t)=>{_[h[t]]=e}),_}function g(e){return e.split(" ")[0].replaceAll("8","eeeeeeee").replaceAll("7","eeeeeee").replaceAll("6","eeeeee").replaceAll("5","eeeee").replaceAll("4","eeee").replaceAll("3","eee").replaceAll("2","ee").replaceAll("1","e").split("")}function v(e){return e.replaceAll("eeeeeeee","8").replaceAll("eeeeeee","7").replaceAll("eeeeee","6").replaceAll("eeeee","5").replaceAll("eeee","4").replaceAll("eee","3").replaceAll("ee","2").replaceAll("e","1")}function P(e,t){var n=g(e).map(e=>(t?"p"==e.toLowerCase():a("both",e)||"k"==e.toLowerCase())||"/"==e?e:"e").join("").split("/").map(e=>({w:e.split("").map((e,t)=>e.toLowerCase()!=e?e:"e"),b:e.split("").map(e=>e.toLowerCase()==e?e:"e")}));return{white:n.map(e=>e.w),black:n.map(e=>e.b)}}var b=new(n(0));const _=["Protected-squares (excl. pieces as defenders, protected pawns, overprotection) {white}","Protected-squares per pawn (excl. pieces as defenders, protected pawns, overprotection) {white}","Over-protected-squares (excl. pieces as defenders, protected pawns) {white}","Protected-squares (excl. pieces as defenders, protected pawns, overprotection) {black}","Protected-squares per pawn (excl. pieces as defenders, protected pawns, overprotection) {black}","Over-protected squares (excl. pieces as defenders, protected pawns) {black}"];const w=["P count {white}","p count {black}","N count {white}","n count {black}","B count {white}","b count {black}","R count {white}","r count {black}","Q count {white}","q count {black}","B > n","N > b","B == N","P == p","b > N","n > B","b == n"];n(0);const m=[0,1,2,3,4,5,6,7],k=[4,5,6,7],E=[0,1,2,3],O=["8/pp3ppp/2p1p3/8/3P4/8/PPP2PPP/8","8/pp3ppp/2p1p3/8/3P4/4P3/PP3PPP/8","8/pp3ppp/3pp3/8/4P3/8/PPP2PPP/8","8/pp2pp1p/3p2p1/8/4P3/8/PPP2PPP/8","8/pp3ppp/3p4/4p3/4P3/8/PPP2PPP/8","8/pp2pppp/3p4/8/2P1P3/8/PP3PPP/8","8/pp1p1ppp/4p3/8/2P1P3/8/PP3PPP/8","8/5ppp/pp1pp3/8/2P1P3/8/PP3PPP/8","8/pp3ppp/2p5/4p3/2P1P3/8/PP3PPP/8","8/pp3ppp/2pp4/8/2P1P3/8/PP3PPP/8","8/ppp2ppp/3p4/3Pp3/4P3/8/PPP2PPP/8","8/ppp2ppp/4p3/3pP3/3P4/8/PPP2PPP/8","8/ppp2ppp/8/8/3P4/8/PP3PPP/8","8/pp3ppp/4p3/8/3P4/8/PP3PPP/8","8/pp3ppp/4p3/8/2PP4/8/P4PPP/8","8/pp3ppp/2p5/3p4/3P4/4P3/PP3PPP/8","8/pp3ppp/4p3/2Pp4/3P4/8/PP3PPP/8","8/ppp2 pp/4p3/3p1p2/3P1P2/4P3/PPP3PP/8","8/pp3ppp/3p4/2p1p3/2P1P3/3P4/PP3PPP/8","8/pp2pppp/3p4/2p5/4P3/3P4/PPP2PPP/8"];var A=[...O].map(e=>g(e));const S=["Open A File","Open B File","Open C File","Open D File","Open E File","Open F File","Open G File","Open H File","Half-Open A File {white}","Half-Open B File {white}","Half-Open C File {white}","Half-Open D File {white}","Half-Open E File {white}","Half-Open F File {white}","Half-Open G File {white}","Half-Open H File {white}","Half-Open A File {black}","Half-Open B File {black}","Half-Open C File {black}","Half-Open D File {black}","Half-Open E File {black}","Half-Open F File {black}","Half-Open G File {black}","Half-Open H File {black}","Double Pawns {white}","Double Pawns {black}","Isolated Pawns {white}","Isolated Pawns {black}","King Side Pawn Majority {white}","Queen Side Pawn Majority {white}","King Side Pawn Majority {black}","Queen Side Pawn Majority {black}","Furthest advanced pawn {white}","Furthest advanced pawn {black}","Least advanced pawn {white}","Least advanced pawn {black}","Avg advanced pawn {white}","Avg advanced pawn {black}","Fianchetto Queen Side {white}","Fianchetto King Side {white}","Fianchetto Queen Side {black}","Fianchetto King Side {black}","Pawn Structure 1st Closest Match","Pawn Structure 2nd Closest Match","Pawn Structure 3rd Closest Match","Pawn Structure 1st Closest Match Count","Pawn Structure 2nd Closest Match Count","Pawn On A3 {white}","Pawn On H3 {white}","Pawn On A4 {white}","Pawn On H4 {white}","Pawn On A6 {black}","Pawn On H6 {black}","Pawn On A5 {black}","Pawn On H5 {black}","Count Pawns On White Squares {white}","Count Pawns On Black Squares {white}","Count Pawns On White Squares {black}","Count Pawns On Black Squares {black}"];function C(e,t,n,r,i,a){return i[r]?0==r?1==e[1]||2==e[1]&&a[1]?1:0:7==r?1==e[6]||2==e[6]&&a[6]?1:0:(1==e[r+1]||2==e[r+1]&&a[r+1])&&(1==e[r-1]||2==e[r-1]&&a[r-1])?1:0:0}function y(e,t){var n=g(e).map(e=>"P"==e||"p"==e||"e"==e||"/"==e?e:"e"),r=A.map(e=>e.map((e,t)=>e==n[t]).filter(e=>e).length),i=Math.max(...r),a=r.indexOf(i),o=Math.max(...r.filter(e=>e<i)),l=r.indexOf(o),u=Math.max(...r.filter(e=>e<o)),s=r.indexOf(u),f=function(e,t){var n=P(e,t);return n.white.map((e,t)=>{return r=e,i=n.black[t],r.map((e,t)=>"e"==e?i[t]:e);var r,i})}(e,!0),h=m.map(e=>f.map(t=>t[e])),d=new Array(8).fill(void 0).map((e,t)=>t%2==0?new Array(8).fill(null).map((e,t)=>t%2!=0):new Array(8).fill(null).map((e,t)=>t%2==0)),v=[].concat.apply([],d),b=h.map(e=>new Set(e)),_=b.map(e=>e.has("p")),w=b.map(e=>e.has("P")),O=b.map(e=>e.size),y=h.map(e=>e.map(e=>"p"==e)),q=h.map(e=>e.map(e=>"P"==e)),x=[].concat.apply([],y),L=[].concat.apply([],q),N=x.filter((e,t)=>v[t]&&e).length,I=x.filter((e,t)=>!v[t]&&e).length,R=L.filter((e,t)=>v[t]&&e).length,F=L.filter((e,t)=>!v[t]&&e).length,T=[1==O[0]?1:0,1==O[1]?1:0,1==O[2]?1:0,1==O[3]?1:0,1==O[4]?1:0,1==O[5]?1:0,1==O[6]?1:0,1==O[7]?1:0,2==O[0]&&_[0]?1:0,2==O[1]&&_[1]?1:0,2==O[2]&&_[2]?1:0,2==O[3]&&_[3]?1:0,2==O[4]&&_[4]?1:0,2==O[5]&&_[5]?1:0,2==O[6]&&_[6]?1:0,2==O[7]&&_[7]?1:0,2==O[0]&&w[0]?1:0,2==O[1]&&w[1]?1:0,2==O[2]&&w[2]?1:0,2==O[3]&&w[3]?1:0,2==O[4]&&w[4]?1:0,2==O[5]&&w[5]?1:0,2==O[6]&&w[6]?1:0,2==O[7]&&w[7]?1:0,p(m.map(e=>q[e].filter(e=>e).length>=2?1:0)),p(m.map(e=>y[e].filter(e=>e).length>=2?1:0)),p(m.map(e=>C(O,0,0,e,w,_))),p(m.map(e=>C(O,0,0,e,_,w))),p(k.map(e=>w[e]?1:0))>p(E.map(e=>w[e]?1:0))?1:0,p(k.map(e=>w[e]?1:0))<p(E.map(e=>w[e]?1:0))?1:0,p(k.map(e=>_[e]?1:0))>p(E.map(e=>_[e]?1:0))?1:0,p(k.map(e=>_[e]?1:0))<p(E.map(e=>_[e]?1:0))?1:0,8-Math.min(...q.map(e=>Math.min(...e.map((e,t)=>e?t:8)))),8-Math.max(...y.map(e=>Math.max(...e.map((e,t)=>e?t:-1)))),8-Math.max(...q.map(e=>Math.max(...e.map((e,t)=>e?t:-1)))),8-Math.min(...y.map(e=>Math.min(...e.map((e,t)=>e?t:8)))),8-c(q.map(e=>c(e.map((e,t)=>e?t:-1).filter(e=>-1!=e))).filter(e=>!isNaN(e)))||-1,8-c(y.map(e=>c(e.map((e,t)=>e?t:-1).filter(e=>-1!=e))).filter(e=>!isNaN(e)))||-1,p([q[2][6],q[1][5],q[0][6]].map(e=>e?1:0)),p([q[7][6],q[6][5],q[5][6]].map(e=>e?1:0)),p([y[2][1],y[1][2],y[0][1]].map(e=>e?1:0)),p([y[7][1],y[6][2],y[5][1]].map(e=>e?1:0)),a,l,s,i,o,q[7][5]?1:0,q[0][5]?1:0,q[7][4]?1:0,q[0][4]?1:0,y[7][2]?1:0,y[0][2]?1:0,y[7][3]?1:0,y[0][3]?1:0,R,F,N,I];if(t)return T;var K={};return T.forEach((e,t)=>{K[S[t]]=e}),K}const q=["Expansion Factor King Side {white}","Expansion Factor King Side {black}","Expansion Factor Queen Side {white}","Expansion Factor Queen Side {black}","Expansion Factor {white}","Expansion Factor {black}"];var x=new(n(0));const L=["cp","halfmove","last move by",...i,...w,..._,...q,...S,...h,...s];function N(e){if(e.commentAfter){var t=e.commentAfter.split("/")[0].replace("\n"," ").split(" ").reverse()[0],n=parseFloat(t);return isNaN(n)?-1:n}return e.commentDiag?e.commentDiag.depth20?parseFloat(e.commentDiag.depth20):e.commentDiag.depth1?parseFloat(e.commentDiag.depth1):void 0:0}function I(e,t){return F(e,t,!1)}function R(e,t){return F(e,t,!0)}function F(e,t,n){x.load_pgn(e);var r=x.fen(),i=N(t),p=x.history().length,c="w"==o(t)?1:0,f=l(t,n),h=function(e,t){var n=e.split(" ")[0].split(""),r=n.filter(e=>a("white",e)),i=n.filter(e=>a("black",e)),o=r.filter(e=>"P"==e).length,l=r.filter(e=>"B"==e).length,p=r.filter(e=>"N"==e).length,c=i.filter(e=>"p"==e).length,u=i.filter(e=>"b"==e).length,s=i.filter(e=>"n"==e).length,f=[o,c,p,s,l,u,r.filter(e=>"R"==e).length,i.filter(e=>"r"==e).length,r.filter(e=>"Q"==e).length,i.filter(e=>"q"==e).length,l>s?1:0,p>u?1:0,l==p?1:0,o==c?1:0,u>p?1:0,s>l?1:0,u==s?1:0];if(t)return f;var h={};return f.forEach((e,t)=>{h[w[t]]=e}),h}(r,n),m=function(e,t){for(var n=P(e,!0),r=0;r<n.black.length;r++)for(var i=0;i<n.black[r].length;i++)n.black[r][i]=7==r&&"e"==n.black[r][i]?"N":r>1&&"e"==n.black[r][i]?"P":0==r&&0==i?"K":0==r&&7==i?"k":"e"==n.black[r][i]?"e":n.black[r][i],n.white[r][i]=0==r&&"e"==n.white[r][i]?"n":r<6&&"e"==n.white[r][i]?"p":7==r&&0==i?"k":7==r&&7==i?"K":"e"==n.white[r][i]?"e":n.white[r][i];var a=[v(n.white.map(e=>e.join("")).join("/")),"w","-","-","0","1"].join(" "),o=[v(n.black.map(e=>e.join("")).join("/")),"b","-","-","0","1"].join(" ");b.load(a);var l=b.moves().filter(e=>!e.toLowerCase().includes("k")&&!e.toLowerCase().includes("="));b.load(o);var p=b.moves().filter(e=>!e.toLowerCase().includes("k")&&!e.toLowerCase().includes("=")),c=a.split("").filter(e=>"P"==e).length,u=o.split("").filter(e=>"p"==e).length,s=l.map(e=>e.split("x")[1]),f=new Set(s);const h=f.size;var d=p.map(e=>e.split("x")[1]),g=new Set(d);const w=g.size;var m=[h,0!=h?h/c:0,s.length-h,w,0!=w?w/u:0,d.length-w];if(t)return{vector:m,opt:{squares_can_capture_w:f,squares_can_capture_b:g}};var k={};return m.forEach((e,t)=>{k[_[t]]=e}),{dict:k,opt:{squares_can_capture_w:f,squares_can_capture_b:g}}}(r,n),k=function(e,t){for(var n=e.split(" ")[0].replace(/[0-9]/g,"").split("/"),r={white_pieces:0,black_pieces:0,white_pieces_ranked:0,black_pieces_ranked:0},i=g(e).join("").split("/"),a={white_pieces_queen_side:0,white_pieces_king_side:0,black_pieces_queen_side:0,black_pieces_king_side:0,white_pieces_queen_side_ranked:0,white_pieces_king_side_ranked:0,black_pieces_queen_side_ranked:0,black_pieces_king_side_ranked:0},o=0;o<n.length;o++){var l=n[o].split("").filter(e=>e.toLowerCase()!=e).join("").split("").length,p=n[o].split("").filter(e=>e.toLowerCase()==e).join("").split("").length,c=(o+1)*l,u=(7-o+1)*p;r.white_pieces+=l,r.black_pieces+=p,r.white_pieces_ranked+=c,r.black_pieces_ranked+=u;var s={white_queen_side:i[o].slice(0,4),white_king_side:i[o].slice(4,8),black_queen_side:i[o].slice(0,4),black_king_side:i[o].slice(4,8)},f=s.white_queen_side.split("").filter(e=>e.toLowerCase()!=e).filter(e=>"e"!=e).length,h=s.white_king_side.split("").filter(e=>e.toLowerCase()!=e).filter(e=>"e"!=e).length,d=s.black_queen_side.split("").filter(e=>e.toLowerCase()!=e).filter(e=>"e"!=e).length,v=s.black_king_side.split("").filter(e=>e.toLowerCase()!=e).filter(e=>"e"!=e).length;a.white_pieces_queen_side_ranked+=f*(o+1),a.white_pieces_queen_side+=f,a.white_pieces_king_side_ranked+=h*(o+1),a.white_pieces_king_side+=h,a.black_pieces_queen_side_ranked+=d*(7-o+1),a.black_pieces_queen_side+=d,a.black_pieces_king_side_ranked+=v*(7-o+1),a.black_pieces_king_side+=v}var P=[a.white_pieces_queen_side_ranked/a.white_pieces_queen_side,a.black_pieces_queen_side_ranked/a.black_pieces_queen_side,a.white_pieces_king_side_ranked/a.white_pieces_king_side,a.black_pieces_king_side_ranked/a.black_pieces_king_side,r.white_pieces/r.white_pieces_ranked,r.black_pieces/r.black_pieces_ranked].map(e=>isNaN(e)||e==1/0?0:e);if(t)return P;var b={};return P.forEach((e,t)=>{b[q[t]]=e}),b}(r,n),E=y(r,n),O=d(x,r,t,m.opt,n),A=function(e,t){var n=e.history({verbose:!0}).map(e=>l(e,!0)).reduce(u);if(t)return n;var r={};return n.forEach((e,t)=>{r[s[t]]=e}),r}(x,n);if(n)return[i,p,c,...f,...h,...m.vector,...k,...E,...O,...A];var S={cp:i,halfmove:p,"last move by":c};return S=Object.assign({},S,f),S=Object.assign({},S,h),S=Object.assign({},S,m.dict),S=Object.assign({},S,k),S=Object.assign({},S,E),S=Object.assign({},S,O),S=Object.assign({},S,A)}}]);